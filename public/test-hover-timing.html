<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hover Background Test</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
        }
        
        .background-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 0;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.6s ease;
        }
        
        .background-layer.visible {
            opacity: 1;
        }
        
        .white-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.65);
            z-index: 2;
        }
        
        .background-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: blur(30px);
            transform: scale(1.1);
            z-index: 1;
        }
        
        .content {
            position: relative;
            z-index: 10;
            background: white;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .article-item {
            padding: 20px;
            border-bottom: 1px solid #ddd;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .article-item:hover {
            padding-left: 40px;
            background: #f5f5f5;
        }
        
        .log-output {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 400px;
            height: 300px;
            background: black;
            color: lime;
            font-family: monospace;
            font-size: 12px;
            padding: 10px;
            overflow-y: auto;
            z-index: 100;
        }
    </style>
</head>
<body>
    <div class="background-layer" id="bg-layer">
        <div class="white-overlay"></div>
        <img class="background-image" id="bg-image" src="" alt="">
    </div>
    
    <div class="content">
        <h1>Hover Background Test</h1>
        <p>Test the 1-second disappearance issue outside of Next.js</p>
        
        <div class="article-item" data-image="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1200&h=800&fit=crop&blur=30">
            <h2>01. Article with Unsplash Image</h2>
        </div>
        
        <div class="article-item" data-image="https://picsum.photos/1200/800?random=1&blur=5">
            <h2>02. Article with Picsum Image</h2>
        </div>
        
        <div class="article-item" data-image="https://images.unsplash.com/photo-1472214103451-9374bd1c798e?w=1200&h=800&fit=crop&blur=30">
            <h2>03. Another Unsplash Image</h2>
        </div>
        
        <div class="article-item" data-image="https://cdn.sanity.io/images/wfg58m28/production/b23158e039b344c9860e22b3ad5cf9c893da7ba4-2560x1706.jpg?w=1200&h=800&fit=crop&blur=30">
            <h2>04. Sanity CDN Image (if accessible)</h2>
        </div>
    </div>
    
    <div class="log-output" id="log">
        <div>Console Log:</div>
    </div>
    
    <script>
        const bgLayer = document.getElementById('bg-layer');
        const bgImage = document.getElementById('bg-image');
        const logDiv = document.getElementById('log');
        let logEntries = [];
        let timeouts = [];
        
        function log(message) {
            const timestamp = new Date().toISOString().split('T')[1].substring(0, 12);
            const entry = `[${timestamp}] ${message}`;
            logEntries.push(entry);
            if (logEntries.length > 20) logEntries.shift();
            logDiv.innerHTML = '<div>Console Log:</div>' + logEntries.map(e => `<div>${e}</div>`).join('');
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        document.querySelectorAll('.article-item').forEach((item, index) => {
            item.addEventListener('mouseenter', () => {
                const imageUrl = item.dataset.image;
                log(`HOVER: Article ${index + 1}`);
                log(`URL: ${imageUrl.substring(0, 50)}...`);
                
                // Clear all existing timeouts
                timeouts.forEach(t => clearTimeout(t));
                timeouts = [];
                
                // Set the image
                bgImage.src = imageUrl;
                bgLayer.classList.add('visible');
                
                // Track what happens over time
                timeouts.push(setTimeout(() => {
                    log(`100ms: BG still visible? ${bgLayer.classList.contains('visible')}`);
                    log(`100ms: Image src: ${bgImage.src ? 'SET' : 'EMPTY'}`);
                }, 100));
                
                timeouts.push(setTimeout(() => {
                    log(`500ms: BG still visible? ${bgLayer.classList.contains('visible')}`);
                    log(`500ms: Image loaded? ${bgImage.complete}`);
                }, 500));
                
                timeouts.push(setTimeout(() => {
                    log(`1000ms: BG still visible? ${bgLayer.classList.contains('visible')}`);
                    log(`1000ms: Image error? ${bgImage.naturalWidth === 0}`);
                }, 1000));
                
                timeouts.push(setTimeout(() => {
                    log(`1500ms: BG still visible? ${bgLayer.classList.contains('visible')}`);
                }, 1500));
            });
            
            item.addEventListener('mouseleave', () => {
                log(`LEAVE: Article ${index + 1}`);
                bgLayer.classList.remove('visible');
                timeouts.forEach(t => clearTimeout(t));
                timeouts = [];
                setTimeout(() => {
                    bgImage.src = '';
                }, 600);
            });
        });
        
        // Monitor for any unexpected changes
        const observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
                if (mutation.target === bgLayer && mutation.attributeName === 'class') {
                    log(`MUTATION: class changed to "${bgLayer.className}"`);
                }
            });
        });
        
        observer.observe(bgLayer, { attributes: true });
        
        log('Test page loaded');
    </script>
</body>
</html>